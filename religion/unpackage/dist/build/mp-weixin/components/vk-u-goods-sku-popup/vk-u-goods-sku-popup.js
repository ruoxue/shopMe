(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/vk-u-goods-sku-popup/vk-u-goods-sku-popup"],{"7d9b":function(e,t,o){"use strict";o.r(t);var n=o("9f54"),u=o.n(n);for(var s in n)"default"!==s&&function(e){o.d(t,e,(function(){return n[e]}))}(s);t["default"]=u.a},8994:function(e,t,o){},"937d":function(e,t,o){"use strict";o.d(t,"b",(function(){return u})),o.d(t,"c",(function(){return s})),o.d(t,"a",(function(){return n}));var n={vkUNumberBox:function(){return o.e("components/vk-u-number-box/vk-u-number-box").then(o.bind(null,"eadc"))}},u=function(){var e=this,t=e.$createElement,o=(e._self._c,e._f("priceFilter")(e.selectShop.price)),n=e.selectArr.join(" "),u=e.__map(e.goodsInfo[e.skuListName],(function(t,o){var n=e.__get_orig(t),u=e.__map(t.spec_items,(function(t,o){var n=e.__get_orig(t),u=e.__get_style([t.ishow?"":e.disableStyle,t.isSelect?e.activedStyle:"",t.ishow?e.btnStyle:""]);return{$orig:n,s0:u}}));return{$orig:n,l0:u}}));e.$mp.data=Object.assign({},{$root:{f0:o,g0:n,l1:u}})},s=[]},"9f54":function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,u,s=c(o("a34a"));function c(e){return e&&e.__esModule?e:{default:e}}function r(e){return f(e)||l(e)||a(e)||i()}function i(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function a(e,t){if(e){if("string"===typeof e)return d(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?d(e,t):void 0}}function l(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function f(e){if(Array.isArray(e))return d(e)}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function p(e,t,o,n,u,s,c){try{var r=e[s](c),i=r.value}catch(a){return void o(a)}r.done?t(i):Promise.resolve(i).then(n,u)}function m(e){return function(){var t=this,o=arguments;return new Promise((function(n,u){var s=e.apply(t,o);function c(e){p(s,n,u,c,r,"next",e)}function r(e){p(s,n,u,c,r,"throw",e)}c(void 0)}))}}var g={name:"vk-u-goods-sku-popup",props:{value:{Type:Boolean,default:!1},goodsId:{Type:String,default:""},action:{Type:String,default:""},noStockText:{Type:String,default:"该商品已抢完"},stockText:{Type:String,default:"库存"},goodsIdName:{Type:String,default:"spec_sku_id"},skuIdName:{Type:String,default:"spec_sku_id"},skuListName:{Type:String,default:"spec_attr"},specListName:{Type:String,default:"spec_attr"},stockName:{Type:String,default:"stock_num"},skuName:{Type:String,default:"sku_name"},skuArrName:{Type:String,default:"spec_items"},defaultSingleSkuName:{Type:String,default:"默认"},mode:{Type:Number,default:1},maskCloseAble:{Type:Boolean,default:!0},borderRadius:{Type:[String,Number],default:0},goodsThumbName:{Type:[String],default:"goods_thumb"},minBuyNum:{Type:Number,default:1},maxBuyNum:{Type:Number,default:1e5},stepBuyNum:{Type:Number,default:1},customAction:{Type:[Function],default:null},priceColor:{Type:String,default:"#fe560a"},buyNowText:{Type:String,default:"立即购买"},buyNowColor:{Type:String,default:"#ffffff"},buyNowBackgroundColor:{Type:String,default:"#fe560a"},addCartText:{Type:String,default:"加入购物车"},addCartColor:{Type:String,default:"#ffffff"},addCartBackgroundColor:{Type:String,default:"#ff9402"},disableStyle:{Type:Object,default:null},activedStyle:{Type:Object,default:null},btnStyle:{Type:Object,default:null},showClose:{Type:Boolean,default:!0},closeImage:{Type:String,default:"https://img.alicdn.com/imgextra/i1/121022687/O1CN01ImN0O11VigqwzpLiK_!!121022687.png"}},data:function(){return{complete:!1,goodsInfo:{},isShow:!1,initKey:!0,shopItemInfo:{},selectArr:[],subIndex:[],selectShop:{},selectNum:this.minBuyNum,outFoStock:!1}},mounted:function(){n=this,u=n.vk,n.value&&n.open()},methods:{init:function(){n.selectArr=[],n.subIndex=[],n.subValueIndex=[],n.selectShop={},n.selectNum=n.minBuyNum,n.outFoStock=!1,n.shopItemInfo={};var e=n.specListName;n.goodsInfo[e].map((function(e){n.selectArr.push(""),n.subIndex.push(-1)})),n.checkItem(),n.checkInpath(-1),n.autoClickSku()},findGoodsInfo:function(){if("undefined"==typeof u)return n.toast("未找到vk依赖"),!1;u.callFunction({url:n.action,title:"请求中...",data:{goods_id:n.goodsId},success:function(e){n.updateGoodsInfo(e.goodsInfo)}})},updateGoodsInfo:function(e){console.log(e);var t=n.skuListName;"{}"===JSON.stringify(n.goodsInfo)||n.goodsInfo[n.goodsIdName]!==e[n.goodsIdName]?(n.goodsInfo=e,n.initKey=!0):n.goodsInfo[t]=e[t],n.initKey&&(n.initKey=!1,n.init());var o=n.getListItem(n.goodsInfo[t],n.skuIdName,n.selectShop[n.skuIdName]);Object.assign(n.selectShop,o),n.complete=!0,n.$emit("open",!0),n.$emit("input",!0)},open:function(){return m(s.default.mark((function e(){var t,o;return s.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=!0,n.skuListName,!n.customAction||"function"!==typeof n.customAction){e.next=16;break}return e.next=5,n.customAction();case 5:if(o=e.sent,!o||"object"!=typeof o||"{}"==JSON.stringify(o)){e.next=11;break}t=!1,n.updateGoodsInfo(o),e.next=14;break;case 11:return n.toast("未获取到商品信息"),n.$emit("input",!1),e.abrupt("return",!1);case 14:e.next=17;break;case 16:t&&n.findGoodsInfo();case 17:case"end":return e.stop()}}),e)})))()},close:function(e){"close"==e?(n.$emit("input",!1),n.$emit("close","close")):"mask"==e&&n.maskCloseAble&&(n.$emit("input",!1),n.$emit("close","mask"))},moveHandle:function(){},skuClick:function(e,t,o,u){console.log(e+"=="+u),e.ishow&&(n.selectArr[t]!=e.spec_value?(n.$set(n.selectArr,t,e.spec_value),n.$set(n.subIndex,t,e.item_id)):(n.$set(n.selectArr,t,""),n.$set(n.subIndex,t,-1)),n.checkInpath(t),n.checkSelectShop())},checkSelectShop:function(){if(n.selectArr.every((function(e){return""!=e}))){n.selectShop=n.shopItemInfo[n.selectArr];for(var e=0;e<n.goodsInfo["spec_list"].length;e++)n.goodsInfo["spec_list"][e].spec_sku_id==n.subIndex.join("_")&&(n.selectShop=n.goodsInfo["spec_list"][e],n.selectShop["goods_sku"]=n.selectArr);n.selectNum=n.minBuyNum}else n.selectShop={}},checkInpath:function(e){for(var t=n.skuListName,o=n.goodsInfo[t],u=0,s=o.length;u<s;u++){console.log(12);for(var c=o[u].spec_items.length,r=0;r<c;r++)o[u].spec_items[r].item_id==n.subIndex[u]?(o[u].spec_items[r].ishow=!0,o[u].spec_items[r].isSelect=!0):(o[u].spec_items[r].ishow=!0,o[u].spec_items[r].isSelect=!1)}n.$set(n.goodsInfo,t,o)},checkItem:function(){for(var e=n.skuListName,t=n.goodsInfo[e],o=0,u=0;u<t.length;u++)t[u][n.stockName]<=0?(t.splice(u,1),u--):o+=t[u][n.stockName];o<=0&&(n.outFoStock=!0);t.reduce((function(e,t){return e.concat(t[n.skuArrName].reduce((function(e,o){return e.concat(e.map((function(e){return n.shopItemInfo.hasOwnProperty([].concat(r(e),[o]))||(n.shopItemInfo[[].concat(r(e),[o])]=t),[].concat(r(e),[o])})))}),[[]]))}),[[]])},checkSelectComplete:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.log("00");var t=n.selectShop;t&&t[n.skuIdName]?n.selectNum<=t.form[n.stockName]?"function"==typeof e.success&&e.success(t):n.toast(n.stockText+"不足","none"):n.toast("请先选择对应规格","none")},addCart:function(){n.checkSelectComplete({success:function(e){e.buy_num=n.selectNum,n.$emit("add-cart",e)}})},buyNow:function(){n.checkSelectComplete({success:function(e){e.buy_num=n.selectNum,n.$emit("buy-now",e)}})},toast:function(t,o){e.showToast({title:t,icon:o})},getListItem:function(e,t,o){var n;for(var u in e)if("object"==typeof o){if(JSON.stringify(e[u][t])===JSON.stringify(o)){n=e[u];break}}else if(e[u][t]===o){n=e[u];break}return n},autoClickSku:function(){n.goodsInfo["spec_list"],n.goodsInfo[n.specListName]}},filters:{priceFilter:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return"string"==typeof e&&(e=parseFloat(e)),(e/100).toFixed(2)}},computed:{},watch:{value:function(e){e&&n.open()}}};t.default=g}).call(this,o("543d")["default"])},ace5:function(e,t,o){"use strict";var n=o("8994"),u=o.n(n);u.a},d653:function(e,t,o){"use strict";o.r(t);var n=o("937d"),u=o("7d9b");for(var s in u)"default"!==s&&function(e){o.d(t,e,(function(){return u[e]}))}(s);o("ace5");var c,r=o("f0c5"),i=Object(r["a"])(u["default"],n["b"],n["c"],!1,null,"fd1ae05c",null,!1,n["a"],c);t["default"]=i.exports}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/vk-u-goods-sku-popup/vk-u-goods-sku-popup-create-component',
    {
        'components/vk-u-goods-sku-popup/vk-u-goods-sku-popup-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("d653"))
        })
    },
    [['components/vk-u-goods-sku-popup/vk-u-goods-sku-popup-create-component']]
]);
